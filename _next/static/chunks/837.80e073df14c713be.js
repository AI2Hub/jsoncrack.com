"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[837],{1837:function(a,b,c){c.r(b),c.d(b,{Graph:function(){return ag}});var d=c(6042),e=c(9396),f=c(828),g=c(7297),h=c(5893),i=c(7294),j=c(6126),k=c(8188),l=c(9189),m=c(2125),n=c(1440);function o(){var a=(0,g.Z)(["\n  text-decoration: underline;\n  pointer-events: all;\n"]);return o=function(){return a},a}function p(){var a=(0,g.Z)(["\n  text-align: ",";\n  font-size: 12px;\n  overflow: hidden;\n  color: ",";\n  pointer-events: none;\n  padding: ",';\n\n  * {\n    font-family: "Roboto Mono", monospace;\n  }\n\n  &.searched {\n    border: 2px solid ',";\n    border-radius: 2px;\n  }\n\n  .highlight {\n    border: 2px dashed #FF2970;\n    background: rgba(255, 214, 0, 0.3);\n  }\n\n  .renderVisible {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    font-size: 12px;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n    cursor: pointer;\n  }\n"]);return p=function(){return a},a}function q(){var a=(0,g.Z)(["\n  display: inline;\n  flex: 1;\n  font-weight: 500;\n  color: ",";\n  font-size: ",";\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding: ",";\n"]);return q=function(){return a},a}function r(){var a=(0,g.Z)(["\n  display: block;\n  height: 18px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  padding: 0 auto;\n"]);return r=function(){return a},a}var s=(0,m.ZP)(n.Ld)(o()),t=m.ZP.foreignObject(p(),function(a){return!a.isObject&&"center"},function(a){return a.theme.TEXT_NORMAL},function(a){return a.isObject&&"10px"},function(a){return a.theme.TEXT_POSITIVE}),u=m.ZP.span(q(),function(a){var b,c,d,e=a.theme,f=a.objectKey,g=a.parent;return b=e,c=void 0!==g&&g,d=void 0!==f&&f,c?b.NODE_KEY:d?b.OBJECT_KEY:b.TEXT_POSITIVE},function(a){return a.parent&&"14px"},function(a){return a.parent&&"10px"}),v=m.ZP.span.attrs(function(a){var b,c;return{style:{color:(b=a["data-key"],c=a.theme,Number.isNaN(+b)?"true"===b?c.TEXT_POSITIVE:"false"===b?c.TEXT_DANGER:void 0:"#FD0079")}}})(r()),w=function(a){var b=a.width,c=a.height,d=a.value,e=a.x,f=a.y,g=i.useRef(null);return(0,l.Z)(function(a){return a.performanceMode}),(0,h.jsx)(t,{width:b,height:c,x:0,y:0,ref:g,isObject:!0,children:d.map(function(a,b){return(0,h.jsxs)(v,{"data-key":JSON.stringify(a[1]),"data-x":e,"data-y":f,children:[(0,h.jsxs)(u,{objectKey:!0,children:[JSON.stringify(a[0]).replaceAll('"',""),":"," "]}),(0,h.jsx)(s,{children:JSON.stringify(a[1])})]},b)})})},x=c(5434),y=c(4924),z=c(6902),A=function(a,b){var c=a.map(function(a){return a.id});return b.filter(function(a){return c.includes(a.from)||c.includes(a.to)})},B=c(9815),C=function(a,b,c){var d=[],e=function(a){var f,g=c.filter(function(b){return b.from===a}).map(function(a){return a.to}),h=b.filter(function(a){return g.includes(a.id)});(f=d).push.apply(f,(0,B.Z)(h)),h.forEach(function(a){return e(a.id)})};return e(a),d},D={nodes:[],edges:[],collapsedNodes:[],collapsedEdges:[]},E=(0,z.ZP)(function(a,b){return(0,e.Z)((0,d.Z)({},D),{setGraphValue:function(b,c){return a((0,y.Z)({collapsedNodes:[],collapsedEdges:[]},b,c))},expandNodes:function(c){var d=C(c,b().nodes,b().edges),e=A(d,b().edges),f=d.map(function(a){return a.id}),g=e.map(function(a){return a.id});a({collapsedNodes:b().collapsedNodes.filter(function(a){return!f.includes(a)}),collapsedEdges:b().collapsedEdges.filter(function(a){return!g.includes(a)})})},collapseNodes:function(c){var d=C(c,b().nodes,b().edges),e=A(d,b().edges),f=d.map(function(a){return a.id}),g=e.map(function(a){return a.id});a({collapsedNodes:b().collapsedNodes.concat(f),collapsedEdges:b().collapsedEdges.concat(g)})}})}),F=c(9577);function G(){var a=(0,g.Z)(["\n  pointer-events: all;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  color: ",";\n  background: rgba(0, 0, 0, 0.1);\n  height: 100%;\n  width: 40px;\n  border-left: 1px solid ",";\n\n  &:hover {\n    background-image: linear-gradient(rgba(0, 0, 0, 0.1) 0 0);\n  }\n"]);return G=function(){return a},a}function H(){var a=(0,g.Z)(["\n  display: flex;\n  justify-content: ",";\n  align-items: center;\n  height: 100%;\n  width: 100%;\n"]);return H=function(){return a},a}var I=m.ZP.button(G(),function(a){return a.theme.TEXT_NORMAL},function(a){return a.theme.BACKGROUND_MODIFIER_ACCENT}),J=m.ZP.div(H(),function(a){return a.hasCollapse?"space-between":"center"}),K=function(a){var b=a.node,c=a.width,d=a.height,e=a.value,g=a.isParent,j=void 0!==g&&g,k=a.hasCollapse,m=void 0!==k&&k,n=a.x,o=a.y,p=i.useRef(null),q=((0,l.Z)(function(a){return a.performanceMode}),(0,F.Z)(function(a){return a.hideCollapse})),r=E(function(a){return a.expandNodes}),v=E(function(a){return a.collapseNodes}),w=(0,f.Z)(i.useState(!0),2),y=w[0],z=w[1],A=function(a){a.stopPropagation(),z(!y),y?v(b.id):r(b.id)};return(0,h.jsx)(t,{width:c,height:d,x:0,y:0,"data-nodeid":b.id,ref:p,hideCollapse:q,hasCollapse:j&&m,children:(0,h.jsxs)(J,{hasCollapse:j&&!q,children:[(0,h.jsx)(u,{"data-x":n,"data-y":o,"data-key":JSON.stringify(e),parent:j,children:(0,h.jsx)(s,{children:JSON.stringify(e).replaceAll('"',"")})}),j&&m&&!q&&(0,h.jsx)(I,{onClick:A,children:(0,h.jsx)(x.GKy,{size:18})})]})})},L={fill:"transparent",stroke:"transparent",strokeWidth:0},M=function(a){var b=a.properties;return(0,h.jsx)(k.Node,(0,e.Z)((0,d.Z)({},a),{label:(0,h.jsx)(k.Label,{style:L}),children:function(a){var c=a.width,d=a.height,e=a.x,f=a.y,g=a.node;return Array.isArray(b.text)?(0,h.jsx)(w,{value:b.text,width:c,height:d,x:e,y:f}):(0,h.jsx)(K,{node:g,isParent:b.data.isParent,value:b.text,width:c,height:d,hasCollapse:b.data.hasChild,x:e,y:f})}}))},N=c(6501),O=c(9647),P=c(3565),Q=c(1342);function R(){var a=(0,g.Z)(["\n  resize: none;\n  width: 100%;\n  min-height: 200px;\n\n  padding: 10px;\n  background: ",";\n  color: ",";\n  outline: none;\n  border-radius: 4px;\n  line-height: 20px;\n  border: none;\n"]);return R=function(){return a},a}var S=m.ZP.textarea(R(),function(a){return a.theme.BACKGROUND_TERTIARY},function(a){return a.theme.INTERACTIVE_NORMAL}),T=function(a){var b=a.selectedNode,c=a.visible,d=a.closeModal,e=Array.isArray(b)?Object.fromEntries(b):b,f=function(){N.ZP.success("Content copied to clipboard!"),navigator.clipboard.writeText(JSON.stringify(e)),d()};return(0,h.jsxs)(Q.u,{visible:c,setVisible:d,children:[(0,h.jsx)(Q.u.Header,{children:"Node Content"}),(0,h.jsx)(Q.u.Content,{children:(0,h.jsx)(S,{defaultValue:JSON.stringify(e,function(a,b){return"string"==typeof b?b.replaceAll('"',""):b},2),readOnly:!0})}),(0,h.jsx)(Q.u.Controls,{setVisible:d,children:(0,h.jsxs)(P.z,{status:"SECONDARY",onClick:f,children:[(0,h.jsx)(O.C3L,{size:18})," Clipboard"]})})]})},U=c(374),V=c(2670),W=c(9534),X=function(a){var b=arguments.length>1&& void 0!==arguments[1]&&arguments[1],c=arguments.length>2?arguments[2]:void 0,d="",e=("string"==typeof a?a:a.map(function(a){var b=(0,f.Z)(a,2),c=b[0],d=b[1];return"".concat(c,": ").concat(d)}).join("\n")).split("\n"),g=e.map(function(a){return a.length}).sort(function(a,b){return b-a})[0];return{width:c?35+8*g+(b?60:0):b?150:200,height:17.8*e.length<30?40:(e.length+1)*18}},Y=function(a){var b=(0,f.Z)(a,2),c=(b[0],b[1]),d=Array.isArray(c)&&c.length,e=(0,V.Z)(c,Object);return null!==c&&(d||e)},Z=function(a){var b=(0,f.Z)(a,2),c=(b[0],b[1]);return!(Array.isArray(c)||(0,V.Z)(c,Object))},$=function(a){var b,c=!(arguments.length>1)|| void 0===arguments[1]||arguments[1],d=arguments.length>2&& void 0!==arguments[2]?arguments[2]:(b=0,function(){return String(++b)});return a?[a].flat().map(function(a){var b,e=(b=a,(0,V.Z)(b,Object)?Object.entries(b).filter(Z):String(b)),g=X(e,!1,c),h=g.width,i=g.height;return{id:d(),text:e,width:h,height:i,children:function(a){var b=!(arguments.length>1)|| void 0===arguments[1]||arguments[1],c=arguments.length>2?arguments[2]:void 0;return(0,V.Z)(a,Object)||(a=[a]),Object.entries(a).filter(Y).flatMap(function(a){var d=(0,f.Z)(a,2),e=d[0],g=d[1],h=X(e,!0,b),i=h.width,j=h.height,k=$(g,b,c);return[{id:c(),text:e,children:k,width:i,height:j,data:{isParent:!0,hasChild:!!k.length}},]})}(a,c,d),data:{isParent:!1,hasChild:!1}}}):[]},_=function(a){return a.flatMap(function(a){var b=a.children;return[(0,W.Z)(a,["children"])].concat((0,B.Z)(_(b)))})},aa=function(a){return a.flatMap(function(a){var b=a.id,c=a.children,d=void 0===c?[]:c;return(0,B.Z)(d.map(function(a){var c=a.id;return{id:"e".concat(b,"-").concat(c),from:b,to:c}})).concat((0,B.Z)(aa(d)))})},ab=function(a){var b=!(arguments.length>1)|| void 0===arguments[1]||arguments[1];try{var c=JSON.parse(a);Array.isArray(c)||(c=[c]);var d=[],e=[],f=$(c,b);return(0,B.Z)(_(f)).concat((0,B.Z)(aa(f))).forEach(function(a){ac(a)?d.push(a):e.push(a)}),{nodes:d,edges:e}}catch(g){return console.error(g),N.ZP.error("An error occured while parsing JSON data!"),{nodes:[],edges:[]}}};function ac(a){return"text"in a}function ad(){var a=(0,g.Z)(["\n  position: absolute;\n  width: 100%;\n  height: ",";\n  background: ",";\n  background-image: ",";\n  background-size: 15px 15px;\n\n  :active {\n    cursor: move;\n  }\n\n  .dragging {\n    pointer-events: none;\n  }\n\n  rect {\n    fill: ",";\n  }\n"]);return ad=function(){return a},a}var ae=m.ZP.div(ad(),function(a){return a.isWidget?"100vh":"calc(100vh - 36px)"},function(a){return a.theme.BACKGROUND_SECONDARY},function(a){var b=a.theme;return"radial-gradient(#505050 0.5px, ".concat(b.BACKGROUND_SECONDARY," 0.5px)")},function(a){return a.theme.BACKGROUND_NODE}),af=i.memo(function(a){var b=a.isWidget,c=a.openModal,g=a.setSelectedNode,m=(0,l.Z)(function(a){return a.json}),n=(0,l.Z)(function(a){return a.setConfig}),o=E(function(a){return a.nodes}),p=E(function(a){return a.edges}),q=E(function(a){return a.setGraphValue}),r=(0,f.Z)(i.useState({width:2e3,height:2e3}),2),s=r[0],t=r[1],u=(0,f.Z)((0,l.Z)(function(a){return[a.expand,a.layout]},U.Z),2),v=u[0],w=u[1],x=i.useCallback(function(a,b){g(b.text),c()},[c,g]),y=i.useCallback(function(a){n("zoomPanPinch",a)},[n]),z=i.useCallback(function(a){a.width&&a.height&&t({width:a.width+400,height:a.height+400})},[]),A=i.useCallback(function(){var a=document.querySelector("input:focus");a&&a.blur()},[]);return i.useEffect(function(){var a=ab(m,v),b=a.nodes,c=a.edges;q("nodes",b),q("edges",c)},[v,m,q]),(0,h.jsx)(ae,{isWidget:b,children:(0,h.jsx)(j.d$,{maxScale:2,minScale:.5,initialScale:.7,wheel:{step:.05},zoomAnimation:{animationType:"linear"},doubleClick:{disabled:!0},onInit:y,onPanning:function(a){var b;return null===(b=a.instance.wrapperComponent)|| void 0===b?void 0:b.classList.add("dragging")},onPanningStop:function(a){var b;return null===(b=a.instance.wrapperComponent)|| void 0===b?void 0:b.classList.remove("dragging")},children:(0,h.jsx)(j.Uv,{wrapperStyle:{width:"100%",height:"100%",overflow:"hidden"},children:(0,h.jsx)(k.Canvas,{nodes:o,edges:p,maxWidth:s.width,maxHeight:s.height,direction:w,onLayoutChange:z,onCanvasClick:A,zoomable:!1,animated:!1,readonly:!0,dragEdge:null,dragNode:null,fit:!0,node:function(a){return(0,h.jsx)(M,(0,e.Z)((0,d.Z)({},a),{onClick:x}))},edge:function(a){return(0,h.jsx)(k.Edge,(0,e.Z)((0,d.Z)({},a),{containerClassName:"edge-".concat(a.id)}))}},w)})})})}),ag=function(a){var b=a.isWidget,c=void 0!==b&&b,d=(0,f.Z)(i.useState(!1),2),e=d[0],g=d[1],j=(0,f.Z)(i.useState([]),2),k=j[0],l=j[1],m=i.useCallback(function(){return g(!0)},[]),n=E(function(a){return a.collapsedNodes}),o=E(function(a){return a.collapsedEdges});return i.useEffect(function(){var a=n.map(function(a){return'[id$="node-'.concat(a,'"]')}),b=o.map(function(a){return'[class$="edge-'.concat(a,'"]')});if(document.querySelectorAll(".hide").forEach(function(a){return a.classList.remove("hide")}),a.length){var c=document.querySelectorAll(a.join(",")),d=document.querySelectorAll(b.join(","));c.forEach(function(a){return a.classList.add("hide")}),d.forEach(function(a){return a.classList.add("hide")})}},[n,o]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(af,{openModal:m,setSelectedNode:l,isWidget:c}),!c&&(0,h.jsx)(T,{selectedNode:k,visible:e,closeModal:function(){return g(!1)}})]})}}}])